local SPLL_TOKEN_ALLIANCE = 33005
local SPLL_TOKEN_HORDE = 33004
local SPLL_CAPTURE_BUFF = 33795
local NA_CREDIT_MARKER = 24867

local NA_GUARDS_MAX = 15
local NA_BUFF_ZONE = 3518
local NA_HALAA_GRAVEYARD_ZONE = 3518
local NA_RESPAWN_TIME = 3600000

local WORLDSTATE_UI_HORDE_GUARDS_SHOW = 2503
local WORLDSTATE_UI_ALLIANCE_GUARDS_SHOW = 2502
local WORLDSTATE_UI_GUARDS_MAX = 2493
local WORLDSTATE_UI_GUARDS_LEFT = 2491

local WORLDSTATE_UI_TOWER_SLIDER_DISPLAY = 2495
local WORLDSTATE_UI_TOWER_SLIDER_POS = 2494
local WORLDSTATE_UI_TOWER_SLIDER_N = 2497
   --[[ NA_MAP_HALAA_NEUTRAL = 2671,
    NA_MAP_HALAA_NEU_A = 2676,
    NA_MAP_HALAA_NEU_H = 2677,
    NA_MAP_HALAA_HORDE = 2672,
    NA_MAP_HALAA_ALLIANCE = 2673]]--
local zone_controll = -1
local capture = true

local C_BAR_NEUTRAL = 80 -- the neutral vallue of the capture bar. MUST BE UNDER 100.
local C_BAR_CAPTURE = (100 - C_BAR_NEUTRAL)/2

local self = getfenv(1)
 --                    go  p   n    nH   nA    H    A
local point_data = {182210,50,2671,2677,2676,2672,2673};
local go_data = {
 -- hordec,alliancec,x,y,z,o												NH,	  NA   H    A    fly
{182267,182301,-1815.8,8036.51,-26.2354,-2.89725,0.0,0.0,0.992546,-0.121869,2760,2670,2668,2669,32059}, -- ALLY_ROOST_SOUTH
{182280,182302,-1507.95,8132.1,-19.5585,-1.3439,0.0,0.0,0.622515,-0.782608,2761,2667,2665,2666,32068}, -- ALLY_ROOST_WEST
{182281,182303,-1384.52,7779.33,-11.1663,-0.575959,0.0,0.0,0.284015,-0.95882,2762,2662,2663,2664,32075}, -- ALLY_ROOST_NORTH
{182282,182304,-1650.11,7732.56,-15.4505,-2.80998,0.0,0.0,0.986286,-0.165048,2763,2659,2660,2661,32081}, -- ALLY_ROOST_EAST
{182222,182305,-1825.4022,8039.2602,-26.08,-2.89725,0.0,0.0,0.992546,-0.121869,0,0,0,0,0}, -- HORDE_BOMB_WAGON_SOUTH
{182272,182306,-1515.37,8136.91,-20.42,-1.3439,0.0,0.0,0.622515,-0.782608,0,0,0,0,0}, -- HORDE_BOMB_WAGON_WEST
{182273,182307,-1377.95,7773.44,-10.31,-0.575959,0.0,0.0,0.284015,-0.95882,0,0,0,0,0}, -- HORDE_BOMB_WAGON_NORTH
{182274,182308,-1659.87,7733.15,-15.75,-2.80998,0.0,0.0,0.986286,-0.165048,0,0,0,0,0}, -- HORDE_BOMB_WAGON_EAST
{182266,182297,-1815.8,8036.51,-26.2354,-2.89725,0.0,0.0,0.992546,-0.121869,0,0,0,0,0}, -- DESTROYED_ALLY_ROOST_SOUTH
{182275,182298,-1507.95,8132.1,-19.5585,-1.3439,0.0,0.0,0.622515,-0.782608,0,0,0,0,0}, -- DESTROYED_ALLY_ROOST_WEST
{182276,182299,-1384.52,7779.33,-11.1663,-0.575959,0.0,0.0,0.284015,-0.95882,0,0,0,0,0}, -- DESTROYED_ALLY_ROOST_NORTH
{182277,182300,-1650.11,7732.56,-15.4505,-2.80998,0.0,0.0,0.986286,-0.165048,0,0,0,0,0} -- DESTROYED_ALLY_ROOST_EAST
}

local npc_data = {
{1,1,18816,-1523.92,7951.76,-17.6942,3.51172},
{1,2,18821,-1527.75,7952.46,-17.6948,3.99317},
{1,3,21474,-1520.14,7927.11,-20.2527,3.39389},
{1,4,21484,-1524.84,7930.34,-20.182,3.6405},
{1,5,21483,-1570.01,7993.8,-22.4505,5.02655},
{1,6,18192,-1654.06,8000.46,-26.59,3.37},
{1,7,18192,-1487.18,7899.1,-19.53,0.954},
{1,8,18192,-1480.88,7908.79,-19.19,4.485},
{1,9,18192,-1540.56,7995.44,-20.45,0.947},
{1,10,18192,-1546.95,8000.85,-20.72,6.035},
{1,11,18192,-1595.31,7860.53,-21.51,3.747},
{1,12,18192,-1642.31,7995.59,-25.8,3.317},
{1,13,18192,-1545.46,7995.35,-20.63,1.094},
{1,14,18192,-1487.58,7907.99,-19.27,5.567},
{1,15,18192,-1651.54,7988.56,-26.5289,2.98451},
{1,16,18192,-1602.46,7866.43,-22.1177,4.74729},
{1,17,18192,-1591.22,7875.29,-22.3536,4.34587},
{1,18,18192,-1550.6,7944.45,-21.63,3.559},
{1,19,18192,-1545.57,7935.83,-21.13,3.448},
{1,20,18192,-1550.86,7937.56,-21.7,3.801},
{0,1,18817,-1591.18,8020.39,-22.2042,4.59022},
{0,2,18822,-1588.0,8019.0,-22.2042,4.06662},
{0,3,21485,-1521.93,7927.37,-20.2299,3.24631},
{0,4,21487,-1540.33,7971.95,-20.7186,3.07178},
{0,5,21488,-1570.01,7993.8,-22.4505,5.02655},
{0,6,18256,-1654.06,8000.46,-26.59,3.37},
{0,7,18256,-1487.18,7899.1,-19.53,0.954},
{0,8,18256,-1480.88,7908.79,-19.19,4.485},
{0,9,18256,-1540.56,7995.44,-20.45,0.947},
{0,10,18256,-1546.95,8000.85,-20.72,6.035},
{0,11,18256,-1595.31,7860.53,-21.51,3.747},
{0,12,18256,-1642.31,7995.59,-25.8,3.317},
{0,13,18256,-1545.46,7995.35,-20.63,1.094},
{0,14,18256,-1487.58,7907.99,-19.27,5.567},
{0,15,18256,-1651.54,7988.56,-26.5289,2.98451},
{0,16,18256,-1602.46,7866.43,-22.1177,4.74729},
{0,17,18256,-1591.22,7875.29,-22.3536,4.34587},
{0,18,18256,-1603.75,8000.36,-24.18,4.516},
{0,19,18256,-1585.73,7994.68,-23.29,4.439},
{0,20,18256,-1595.5,7991.27,-23.53,4.738};
}

function OnLoad(pGO)
self[tostring(pGO)] = {
plrvall = 0
};
if(point_data[1][1] == pGO:GetEntry())then
	if(point_data[1][2] < 100 - C_BAR_CAPTURE and point_data[1][2] > C_BAR_CAPTURE)then
		pGO:SetByte(GAMEOBJECT_BYTES_1,2,21)
	elseif(point_data[1][2] < 100 - C_BAR_CAPTURE)then
		pGO:SetByte(GAMEOBJECT_BYTES_1,2,1)
	elseif(point_data[1][2] >= 100 - C_BAR_CAPTURE)then
		pGO:SetByte(GAMEOBJECT_BYTES_1,2,2)
	end
end
pGO:RegisterAIUpdateEvent(1000)
end

function AIUpdate(pGO)
if(pGO == nil)then
	pGO:RemoveAIUpdateEvent()
end
local vars = self[tostring(pGO)]
if(pGO:GetClosestPlayer())then
	for k,m in pairs (pGO:GetInRangePlayers())do
	if(m:IsPvPFlagged() and m:IsStealthed() == false and m:IsAlive() and battle == 1)then
		if(pGO:GetDistanceYards(m) <= 90)then
			if(m:GetTeam() == 0)then
				vars.plrvall = vars.plrvall + 1
			elseif(m:GetTeam() == 1)then
				vars.plrvall = vars.plrvall - 1
			end
			m:SetWorldStateForPlayer(WORLDSTATE_UI_TOWER_SLIDER_DISPLAY,1)
			if(pGO:GetEntry() == point_data[1][1])then
				m:SetWorldStateForPlayer(WORLDSTATE_UI_TOWER_SLIDER_POS,point_data[1][2])
			end
			m:SetWorldStateForPlayer(WORLDSTATE_UI_TOWER_SLIDER_N,C_BAR_NEUTRAL)
		else
			m:SetWorldStateForPlayer(WORLDSTATE_UI_TOWER_SLIDER_DISPLAY,0)
			m:SetWorldStateForPlayer(WORLDSTATE_UI_TOWER_SLIDER_POS,0)
			m:SetWorldStateForPlayer(WORLDSTATE_UI_TOWER_SLIDER_N,0)
		end
	end
end
end
end

RegisterGameObjectEvent(point_data[i][1],5,AIUpdate)
RegisterGameObjectEvent(point_data[i][1],2,OnLoad)
